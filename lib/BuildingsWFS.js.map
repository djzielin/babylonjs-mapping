{"version":3,"file":"BuildingsWFS.js","sourceRoot":"","sources":["../src/BuildingsWFS.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,mBAAmB,EAAE,MAAM,aAAa,CAAC;AAIlD,OAAO,SAAS,MAAM,aAAa,CAAC;AAEpC,MAAM,CAAC,OAAO,OAAO,YAAa,SAAQ,SAAS;IAO/C,YAAY,IAAY,EAAS,GAAW,EAAS,SAAiB,EAAS,UAA0B,EAAE,OAAgB;QACvH,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QADQ,QAAG,GAAH,GAAG,CAAQ;QAAS,cAAS,GAAT,SAAS,CAAQ;QAAS,eAAU,GAAV,UAAU,CAAgB;QANlG,eAAU,GAAG,aAAa,CAAC;QAC3B,cAAS,GAAG,EAAE,CAAC;QACtB,uCAAuC;QAChC,eAAU,GAAG,qBAAqB,CAAC;QACnC,gBAAW,GAAG,KAAK,CAAC;QAKvB,IAAI,CAAC,cAAc,EAAE,CAAC;IAC1B,CAAC;IAEM,SAAS;QACZ,IAAI,CAAC,SAAS,GAAG,uBAAuB,CAAC;QACzC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;IAC5B,CAAC;IAEM,cAAc;QACjB,IAAI,CAAC,SAAS,GAAG,kCAAkC,CAAC;QACpD,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;IAC7B,CAAC;IAEM,qBAAqB,CAAC,IAAU;QACnC,MAAM,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAE9E,MAAM,UAAU,GAAG,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC;QACjD,MAAM,MAAM,GAAG,QAAQ;YACnB,UAAU,CAAC,CAAC,GAAG,GAAG;YAClB,UAAU,CAAC,CAAC,GAAG,GAAG;YAClB,UAAU,CAAC,CAAC,GAAG,GAAG;YAClB,UAAU,CAAC,CAAC,GAAG,GAAG;YAClB,2BAA2B,CAAC;QAEhC,MAAM,UAAU,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,GAAG,UAAU,GAAG,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC;QAEvG,MAAM,OAAO,GAAoB;YAC7B,WAAW,EAAE,mBAAmB,CAAC,QAAQ;YACzC,IAAI,EAAE,IAAI;YACV,UAAU,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE;YACnC,cAAc,EAAE,IAAI,CAAC,UAAU;YAC/B,GAAG,EAAE,UAAU;YACf,UAAU,EAAE,KAAK;YACjB,WAAW,EAAE,IAAI,CAAC,WAAW;SAChC,CAAA;QACD,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACxC,CAAC;CACJ","sourcesContent":["import { ProjectionType } from \"./TileMath\";\nimport { BuildingRequest } from \"./Buildings\";\nimport { BuildingRequestType } from \"./Buildings\";\n\nimport Tile from \"./Tile\";\nimport TileSet from \"./TileSet\";\nimport Buildings from \"./Buildings\";\n\nexport default class BuildingsWFS extends Buildings {\n    public urlService = \"service=WFS\";\n    public urlOutput = \"\";\n    //public urlVersion = \"&version=1.0.0\";\n    public urlRequest = \"&request=GetFeature\";\n    public flipWinding = false;\n\n    constructor(name: string, public url: string, public layerName: string, public projection: ProjectionType, tileSet: TileSet) {\n        super(name, tileSet);\n\n        this.setupGeoServer();\n    }\n\n    public setupAGOL() {\n        this.urlOutput = \"&outputFormat=GEOJSON\";\n        this.flipWinding = true;\n    }\n\n    public setupGeoServer() {\n        this.urlOutput = \"&outputFormat=application%2Fjson\";\n        this.flipWinding = false;\n    }\n\n    public SubmitLoadTileRequest(tile: Tile) {\n        const bboxValues = this.tileSet.ourTileMath.computeBBOX_4326(tile.tileCoords);\n\n        const urlFeature = \"&typeName=\" + this.layerName;\n        const urlBox = \"&bbox=\" +\n            bboxValues.x + \",\" +\n            bboxValues.y + \",\" +\n            bboxValues.z + \",\" +\n            bboxValues.w + \",\" +\n            \"urn:ogc:def:crs:EPSG:4326\";\n\n        const urlWithBox = this.url + this.urlService + this.urlRequest + urlFeature + this.urlOutput + urlBox;\n\n        const request: BuildingRequest = {\n            requestType: BuildingRequestType.LoadTile,\n            tile: tile,\n            tileCoords: tile.tileCoords.clone(),\n            projectionType: this.projection,\n            url: urlWithBox,\n            inProgress: false,\n            flipWinding: this.flipWinding\n        }\n        this.buildingRequests.push(request);\n    }\n}\n"]}